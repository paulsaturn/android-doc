1. 服务器安装ssh,git, python-setuptools
sudo apt-get install openssh-server openssh-client
sudo apt-get install git-core
sudo apt-get install python-setuptools

2. 服务器安装gitosis
cd /tmp
#git clone git://eagain.net/gitosis.git
git clone https://github.com/res0nat0r/gitosis.git
git clone git://github.com/res0nat0r/gitosis.git
cd gitosis
sudo python setup.py install
 
3. 客户端
sudo apt-get install openssh-server openssh-client
sudo apt-get install git-core
ssh-keygen -t rsa
scp .ssh/id_rsa.pub cjcheng@192.168.1.108:/tmp
 
4. 服务器配置 git服务器
创建git服务器管理用户
sudo useradd -m git
sudo passwd git
vim /etc/passwd //将git /bin/sh改为/bin/bash
sudo mkdir /home/git/repositories
sudo chown git:git /home/git/repositories
sudo chmod 755 /home/git/repositories
git config --global user.name "cjcheng"
git config --global user.email "caijicheng2006@163.com"
 
5. 服务器初始化gitosis
sudo -H -u git gitosis-init < /tmp/id_rsa.pub
sudo chmod 755 /home/git/repositories/gitosis-admin.git/hooks/post-update
 
6. 客户端clone gitosis
git clone git@192.168.1.108:gitosis-admin.git

7. 客户端创建test.git
sudo vim gitosis-admin/gitosis.conf
[group test]
members = cjcheng@cjcheng
writable = test
提交
git add .
git commit -m "add test project"
git push origin master
mkdir test
cd test
git init
echo "hello" > readme
git add .
git commit -m "readme"
git remote add origin git@192.168.1.108:test.git
git push origin master
 
8.另一个客户端git clone
su cjc
ssh-keygen -t rsa
exit
cp ~/.ssh/id_rsa.pub ~/gitosis-admin/keydir/cjc@cjcheng.pub
sudo sudo vim gitosis-admin/gitosis.conf
[group test]
members = cjcheng@cjcheng cjc@cjcheng
writable = test
git add .
git commit -m "add user cjc"
git push origin master
git clone git@192.168.1.108:test.git

================================================================================
常用的git命令
================================================================================
git diff --cached  比较暂存区内的文件与上次提交的差别。
git commit -a -m 'added new benchmarks' 一步部到位提交文件，只针对已经有跟踪的文件，对于新文件，还是要用add
git rm --cached readme.txt只是从暂存区内删除，用于已经添加了，但是文件不需要删除，
git rm log/\*.log  删除所有log/ 目录下扩展名为.log 的文件
git rm \*~      递归删除当前目录及其子目录中所有~ 结尾的文件。
git log --stat 显示简要的增改行数统计 列出每次更改 文件的列表
git log --pretty=oneline   列出版本 号与提交的备注
git log --pretty=format:"%h - %an, %ar : %s"可以定制要显示的记录格式
git log --pretty=format:"%h %s" --graph  查看出分支的情况
git commit --amend    当提交后还想提交文件，此时先add剩下的文件，然后执行此句，进行重新提交
git reset HEAD filename  取消已经放在暂缓区内的东西

有时候发现某个关键文件被改动了，需要跟踪查看对这个关键文件的所有commit的记录，以便理解其中的修改原因和过程
git log -p “file name”
git blame “file name" 可以显示这个文件的每一行的最后提交commit，方便定位commit

分支
git checkout -b iss53  新建分支，并转到分支
git merge hotfix  合并分支
git branch -d hotfix 合并完后删除某个分支
git branch  查看所有分支
git branch --merge 查看哪些分支已被并入当前分支
git branch --no-merged  还没有合并的分支
合并前也必须保证主分支也已经提交了合并时必须回到主分支，然后进行合并; 在进行分支切换时必须保证文件已经提交完如果合并有冲突则进行，解决并提交;

git切换到另外一个branch (本例是develop分支):
git checkout develop

git删除一个branch(本例是myfeature):
git branch -d myfeature

git删除一个远程branch:
git push origin :branchName

git push 新的branch到远程:
git push -u origin mynewfeature

设置git email:
git config --global user.email "me@example.com"

如果你有未提交的commit，与master同步:
git pull --rebase origin master


如果你要把你的分支合并到主干分支，从主干（master）分支上发送：
git branch -d new_feature

假如修改已经合并了，它只会删除分支。假如分支没有合并，你会得到一个错误信息。删除一个未合并的分支（通常你不想保留的修改），你需要发送一样的命令附带一个大写D。意思是“强制删除分支，无论如何我不想要它了。”：
git branch -D new_feature

简单地用提交的ID做签出（checkout）（我通常只用到ID开头的9个字符）
git checkout 085bb3bcb

你也可以签出到一个新的分支，像这样：
git checkout -b my_previous_version 085bb3bcb




================================================================================
git revert 是撤销某次操作，此次操作之前的commit都会被保留
git reset 是撤销某次提交，但是此次之后的修改都会被退回到暂存区
================================================================================
具体一个例子，假设有三个commit， git st:
commit3: add test3.c
commit2: add test2.c
commit1: add test1.c
当执行git revert HEAD~1时， commit2被撤销了
git log可以看到：
commit1：add test1.c
commit3：add test3.c
git status 没有任何变化
如果换做执行git reset --soft(默认) HEAD~1后，运行git log
commit2: add test2.c
commit1: add test1.c
运行git status， 则test3.c处于暂存区，准备提交。
如果换做执行git reset --hard HEAD~1后，
显示：HEAD is now at commit2，运行git log
commit2: add test2.c
commit1: add test1.c
运行git st， 没有任何变化
另外：
git revert <commit log string>是撤消该commit，作为一个新的commit。

================================================================================
Git fetch和git pull的区别
================================================================================
Git中从远程的分支获取最新的版本到本地有这样2个命令：
1. git fetch：相当于是从远程获取最新版本到本地，不会自动merge
	git fetch origin master
	git log -p master..origin/master
	git merge origin/master

    以上命令的含义：
   首先从远程的origin的master主分支下载最新的版本到origin/master分支上
   然后比较本地的master分支和origin/master分支的差别
   最后进行合并
   上述过程其实可以用以下更清晰的方式来进行：

	git fetch origin master:tmp
	git diff tmp 
	git merge tmp

    从远程获取最新的版本到本地的test分支上
   之后再进行比较合并
   
2. git pull：相当于是从远程获取最新版本并merge到本地

	git pull origin master

	上述命令其实相当于git fetch 和 git merge
	在实际使用中，git fetch更安全一些
	因为在merge前，我们可以查看更新情况，然后再决定是否合并
	结束
